Here is SQL queries with a common table expression:
1.  Count of film_id					
	SELECT DISTINCT film_id					
	FROM film					
2.	Release year of the films					
	SELECT DISTINCT release_year					
	FROM film					
3. 	Language of films					
	SELECT DISTINCT A.language_id,					
	B.name					
	FROM film A					
	INNER JOIN language B ON A.language_id=B.language_id					
4.	Maximum rental duration					
	SELECT MAX (rental_duration)					
	fROM film					
5.	Count of the films which have maximum rental duration					
	SELECT COUNT (film_id)					
	FROM film					
	WHERE rental_duration = 7					
6.	Minimum rental duration					
	SELECT MIN (rental_duration)					
	FROM film					
7.	Count of the films which have minimum rental duration					
	SELECT COUNT (film_id)					
	FROM film					
	WHERE rental_duration = 3		
8.	Average rental duration								
	SELECT AVG(rental_duration)								
	FROM film								
9.	Maximum rental rate								
	SELECT MAX (rental_rate) 								
	FROM film								
10.	Minimum rental rate								
	SELECT MIN(rental_rate)								
	FROM film								
11.	Film count by rental rate								
	SELECT rental_rate								
	COUNT(film_id)								
	FROM film								
	GROUP BY rental_rate								
12.	Average film length								
	SELECT AVG(length)								
	FROM film								
13.	Titles of the longest films (Length=185)								
	SELECT film_id,								
	title,								
	length								
	FROM film								
	ORDER BY length DESC								
14.	Titles of the shortest films (Length=46)								
	SELECT film_id,								
	title,								
	length								
	FROM film								
	ORDER BY length ASC								
15.	Maximum replacement cost								
	SELECT MAX (replacement_cost)								
	FROM film								
16.	Minimum replacement cost								
	SELECT MIN(replacement_cost)								
	FROM film								
17.	Average replacement cost								
	SELECT AVG(replacement_cost)								
	FROM film								
18.	Film count by rating								
	SELECT rating								
	COUNT (film_id)								
	FROM film								
	GROUP BY rating								
19.	Customer count								
	SELECT COUNT(customer_id) 								
	FROM customer								
20.	Store count								
	SELECT COUNT(DISTINCT store_id)  								
	FROM customer								
21.	Customer count of the stores								
	SELECT store_id,								
	COUNT (customer_id)								
	FROM customer								
	GROUP BY store_id								
22.	top 10 countries for Rockbuster in terms of customer numbers.								
	SELECT country								
	COUNT (customer_id) AS count_customers								
	FROM customer A								
	INNER JOIN address B ON A.address_id=B.address_id								
	INNER JOIN city C ON B.city_id=C.city_id								
	INNER JOIN country D ON C.country_id=D.country_id								
	GROUP BY country								
	ORDER BY COUNT(customer_id) DESC								
	LIMIT 10								
23.	Top 10 cities within the top 10 countries								
	SELECT city								
	COUNT (customer_id) AS count_customer								
	FROM customer A								
	INNER JOIN address B ON A.address_id=B.address_id								
	INNER JOIN city C ON B.city_id=C.city_id								
	INNER JOIN country D ON C.country_id=D.country_id								
	WHERE country IN ('India', 'China', 'United States', 'Japan', 'Mexico',								
	Brazil','Russian Federation', 'Philippines', 'Turkey',								
	Indonesia')								
	GROUP BY city								
	ORDER BY COUNT (customer_id) DESC								
	LIMIT 10								
24.	Top 5 customers in the top 10 cities who have paid the highest total amounts to Rockbuster.								
	SELECT A.customer_id								
	A.first_name								
	A.last_name								
	SUM (P.amount) AS total_paid								
	G.city								
	K.country								
	FROM customer A								
	INNER JOIN payment P ON A.customer_id=P.customer_id								
	INNER JOIN address C ON A.address_id=C.address_id								
	INNER JOIN city G ON C.city_id=G.city_id								
	INNER JOIN country K ON G.country_id=K.country_id								
	WHERE city IN ('Aurora', 'Tokat', 'Tarsus', 'Atlixco',								
	Emeishan', 'Pontianak', 'Shimoga',								
	Aparecida de Goinia', 'Zalantun',								
	Taguig')								
	GROUP BY A.customer_id, G.city, K.country								
	ORDER BY total_paid DESC								
	LIMIT 5								

